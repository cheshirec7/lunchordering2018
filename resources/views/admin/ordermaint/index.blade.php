@extends('layouts.app')@section('title', 'Order Maintenance :: '.config('app.name'))@push('after-styles')    <style>        div.dataTables_wrapper div.dataTables_info {            padding-top: 0;        }        #ordermaint-table td:nth-child(4) {            text-align: right;            padding-right: 0.75rem;        }        .switchtext {            font-size: 13px;            margin: 3px 7px 0;            padding: 0;        }        #switchLockUnlock {            margin-top: 6px;            display:none;        }        #ordermaint-table .locked {            color: #EB9316;        }        .switch.switch-text {            width: 73px;        }        .switch.switch-text .switch-input:checked ~ .switch-handle {            left: 52px;        }        .switch.switch-text .switch-label::before,        .switch.switch-text .switch-label::after {            margin-top: -0.4em;            width: 100%;        }        .switch.switch-text .switch-label::before {            text-align: right;        }        .switch.switch-text .switch-label::after {            text-align: left;        }    </style>@endpush@section('content')    <div class="col mx-auto mt-xl-4 mt-2">        <div class="card">            <div class="card-header">                <h3><i class="fa fa-th"></i>Order Maintenance</h3>            </div>            <div class="card-body">                @include('includes.partials.messages')                <div class="form-group row">                    <label for="select_date" class="col-form-label ml-3">Date</label>                    <div class="ml-2">                        <select class="form-control custom-select" id="select_date" name="select_date">                            <option value="0">- Select -</option>                            @foreach($options as $option)                                {!! $option !!}                            @endforeach                        </select>                    </div>                    <div id="switchLockUnlock" class="ml-3">                        <label class="switch switch-text switch-success">                            <input id="switchLockUnlockInput" name="switchLockUnlockInput" type="checkbox"                                   class="switch-input">                            <span class="switch-label" data-on="&nbsp;Open" data-off="Locked&nbsp;"></span>                            <span class="switch-handle"></span>                        </label>                    </div>                </div>                <hr/>                <div class="table-responsive">                    <table id="ordermaint-table" class="table table-bordered table-striped table-sm">                        <thead class="thead-dark">                        <tr>                            <th>Ordered By&nbsp;</th>                            <th>Order Description&nbsp;</th>                            <th>Grade&nbsp;</th>                            <th width="1">Price&nbsp;</th>                            <th width="1">Status&nbsp;</th>                            {{--<th>Notes&nbsp;</th>--}}                            {{--<th width="1">Actions&nbsp;</th>--}}                        </tr>                        </thead>                    </table>                </div>            </div>        </div>    </div>@endsection@push('after-scripts')    {!! Html::script("https://cdn.datatables.net/v/bs4/dt-1.10.16/datatables.min.js") !!}    <script>        $(document).ready(function () {            var $selDates = $("select[name='select_date']").change(function (e) {                    var $selDate = $selDates.find(':selected'),                        locked = $selDate.data('locked'),                        numDays = $selDate.data('daysfromtoday'),                        lunchdate_id = parseInt($selDates.val());                    if (lunchdate_id === 0) {                        $dataTable.clear().draw();                        $switchLockUnlock.hide();                        return;                    }                    $dataTable.ajax.url('{!! url("admin/ordermaint") !!}/' + lunchdate_id).load(function (json) {                        if (numDays >= 0) {                            $switchLockUnlockInput.prop('checked', !locked);                            $switchLockUnlock.show();                        } else {                            $switchLockUnlock.hide();                        }                    });                }),                $switchLockUnlock = $('#switchLockUnlock'),                $switchLockUnlockInput = $('#switchLockUnlockInput').change(function (e) {                    var $selDate = $selDates.find(':selected'),                        thetext = $selDate.text(),                        lunchdate_id = $selDates.val();                    $.ajax({                        type: 'POST',                        url: '{!! route("admin.ordermaint.toggle") !!}?ldid=' + lunchdate_id,                        dataType: 'json'                    }).done(function (data) {                        if (data.error) {                            location.reload();                        }                        $switchLockUnlockInput.prop('checked', !data.locked);                        if (data.locked) {                            thetext = thetext.substr(0, thetext.indexOf('(') - 1);                            $selDate.text(thetext);                            $selDate.data('locked', 1);                        } else {                            $selDate.text(thetext + ' (Ordering Open)');                            $selDate.data('locked', 0);                        }                        $dataTable.ajax.reload();                    })                }),                $dataTable = $('#ordermaint-table').DataTable({                    // dom: 'lfrtip',                    dom: 'ti',                    processing: false,                    // serverSide: true,                    serverSide: false,                    autoWidth: false,                    ajax: {                        url: '{!! url("admin/ordermaint") !!}/'+$selDates.val(),                        type: 'get',                        error: function (xhr, err) {                            if (err === 'parsererror')                                location.reload();                        }                    },                    columns: [                        {data: 'name', name: 'name'},                        {data: 'short_desc', name: 'short_desc'},                        {data: 'grade_desc', name: 'gl.grade_desc'},                        {data: 'total_price', name: 'total_price', searchable: false, sortable: true},                        {data: 'status_code', name: 'status_code', searchable: false, sortable: false},//                        {data: 'notes', name: 'notes'},//                        {data: 'actions', name: 'actions', searchable: false, sortable: false}                    ],                    // lengthMenu:[ [20, 50, -1], [20, 50, "All"] ],                    lengthMenu: [[-1], ["All"]],                    order: [[0, 'asc']],                    search: {caseInsensitive: !0},                    language: {                        emptyTable: 'No orders found',                        search: 'Search'                    }                });        });    </script>@endpush